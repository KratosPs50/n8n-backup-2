{
  "createdAt": "2024-11-09T16:01:08.250Z",
  "updatedAt": "2024-11-09T16:01:08.250Z",
  "id": "SEHMcqygbNQDSSnp",
  "name": "Envio de Botões - N8N + EvolutionAPI 2.2",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "operation": "set",
        "key": "id_botao",
        "value": "={{ $json.keyID }}"
      },
      "id": "f7885fc0-a28a-4fd2-9e4b-6836863b3bbe",
      "name": "RECUPERA ID BOTÃO 1",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        220,
        140
      ]
    },
    {
      "parameters": {
        "operation": "set",
        "key": "id_botao",
        "value": "={{ $json.keyID }}"
      },
      "id": "cded27ef-7b64-4911-be98-d46361025828",
      "name": "RECUPERA ID BOTÃO 2",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        220,
        300
      ]
    },
    {
      "parameters": {
        "operation": "set",
        "key": "id_botao",
        "value": "={{ $json.keyID }}"
      },
      "id": "94d6c99a-efdc-493a-94cc-e850e80fbd01",
      "name": "RECUPERA ID BOTÃO 3",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        220,
        460
      ]
    },
    {
      "parameters": {
        "operation": "set",
        "key": "id_botao",
        "value": "{{ $json.body.data.key.id }}"
      },
      "id": "0920faa0-b56d-465c-8821-6b84f913013e",
      "name": "ARMAZENA ID BOTÃO",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        460,
        -20
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.baseUrl.replace(/\\/$/, '') }}/message/sendButtons/{{ $json.instance }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $json.apikey }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "number",
              "value": "={{ $json.remoteJid }}"
            },
            {
              "name": "title",
              "value": "🚨 BLACK FRIDAY CHEGOU! 🚨"
            },
            {
              "name": "description",
              "value": "🔥 Aproveite ganhe até R$ 120 de DESCONTO usando o cupom BLACK 🔥"
            },
            {
              "name": "footer",
              "value": "⏰ Oferta limitada, não fique de fora!"
            },
            {
              "name": "buttons",
              "value": "={{ \n[\n{\n\"type\": \"reply\",\n\"displayText\": \"Botão A\",\n\"id\": \"1\"\n},\n{\n\"type\": \"reply\",\n\"displayText\": \"Botão B\",\n\"id\": \"2\"\n},\n{\n\"type\": \"reply\",\n\"displayText\": \"Botão C\",\n\"id\": \"3\"\n}\n] \n}}"
            },
            {
              "name": "thumbnailUrl",
              "value": "={{ $json.tumbnail }}"
            }
          ]
        },
        "options": {}
      },
      "id": "712f571d-0dba-4335-bc0e-f8c7a7f7bea2",
      "name": "ENVIO DOS BOTÕES",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        220,
        -20
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fb8c146c-9dff-4731-9f3e-eb1f79d2280d",
              "name": "baseUrl",
              "value": "={{ $json.body.server_url }}",
              "type": "string"
            },
            {
              "id": "cfc6844d-86a3-438d-a607-84f42114bba9",
              "name": "apikey",
              "value": "={{ $json.body.apikey }}",
              "type": "string"
            },
            {
              "id": "ff31f2bb-ba58-42cf-9fb4-366040da2b79",
              "name": "remoteJid",
              "value": "={{ $json.body.data.key.remoteJid }}",
              "type": "string"
            },
            {
              "id": "84153324-bc47-4f51-8eed-23521d9638ef",
              "name": "keyID",
              "value": "={{ $json.body.data.key.id }}",
              "type": "string"
            },
            {
              "id": "9ae8d2a5-d8e3-47f2-b292-4124629d25d1",
              "name": "instance",
              "value": "={{ $json.body.instance }}",
              "type": "string"
            },
            {
              "id": "a04dba9f-c215-4ac6-a3ce-76ebea012da5",
              "name": "pushName",
              "value": "={{ $json.body.data.pushName }}",
              "type": "string"
            },
            {
              "id": "1f2c870d-9532-4f01-8e8f-ff39da52682d",
              "name": "tumbnail",
              "value": "https://i.postimg.cc/DyqWTyM5/ads-2-1.png",
              "type": "string"
            },
            {
              "id": "ba2b5e6c-84c1-4909-8916-3024569624c5",
              "name": "selectedId ",
              "value": "={{ $json.body.data.message.templateButtonReplyMessage.selectedId }}",
              "type": "string"
            },
            {
              "id": "dfa4fbb0-3933-4cef-8ef8-c76e69a64924",
              "name": "messageConversation",
              "value": "={{ $json.body.data.message.conversation }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "d7a41169-806c-404c-91dd-3d53f42e5897",
      "name": "VARIÁVEIS",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -40,
        -20
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Webhook').item.json.body.server_url }}/message/sendText/{{ $('Webhook').item.json.body.instance }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $('Webhook').item.json.body.apikey }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "number",
              "value": "={{ $('Webhook').item.json.body.data.key.remoteJid }}"
            },
            {
              "name": "text",
              "value": "Você escolheu o botão A"
            }
          ]
        },
        "options": {}
      },
      "id": "22a0d083-eaac-43e2-a42f-238973255c69",
      "name": "RESPOSTA BOTÃO 1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        460,
        140
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Webhook').item.json.body.server_url }}/message/sendText/{{ $('Webhook').item.json.body.instance }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $('Webhook').item.json.body.apikey }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "number",
              "value": "={{ $('Webhook').item.json.body.data.key.remoteJid }}"
            },
            {
              "name": "text",
              "value": "Você escolheu o botão B"
            }
          ]
        },
        "options": {}
      },
      "id": "521bb640-6d9f-47b0-a948-ba5ca1564062",
      "name": "RESPOSTA BOTÃO 2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Webhook').item.json.body.server_url }}/message/sendText/{{ $('Webhook').item.json.body.instance }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $('Webhook').item.json.body.apikey }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "number",
              "value": "={{ $('Webhook').item.json.body.data.key.remoteJid }}"
            },
            {
              "name": "text",
              "value": "Você escolheu o botão C"
            }
          ]
        },
        "options": {}
      },
      "id": "af52f43b-2908-4440-92a5-1cae636554a7",
      "name": "RESPOSTA BOTÃO 3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        460,
        460
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "EvolutionAPI",
        "options": {}
      },
      "id": "951cc951-32b7-4ecc-9c5c-d25d353821a9",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -260,
        -20
      ],
      "webhookId": "412b1047-e4aa-495a-9eed-e809298e94a3"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.messageConversation }}",
                    "rightValue": "bot",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3698d1b8-c02a-458d-9884-bfbf495b99f3",
                    "leftValue": "={{ $json['selectedId '] }}",
                    "rightValue": "1",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "41863bef-4f9d-4ca5-ac60-0d7d9e56d787",
                    "leftValue": "={{ $json['selectedId '] }}",
                    "rightValue": "2",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "ea550f16-63b4-49c2-b34b-6081ed1172ea",
                    "leftValue": "={{ $json['selectedId '] }}",
                    "rightValue": "3",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "d3ca558c-8f6e-42ff-b22b-3c58958ad5fa",
      "name": "GATILHO + ESCOLHA DO BOTÃO",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -40,
        220
      ]
    },
    {
      "parameters": {
        "content": "🚨 BLACK FRIDAY CHEGOU! 🚨\n\n🔥 Aproveite ganhe até R$ 120 de DESCONTO usando o cupom BLACK 🔥\n\n🔑 Não perca essa chance de transformar seu negócio com automação inteligente e poderosa! 💼💥\n🚀 Automatize suas vendas e conquiste mais liberdade com o Pack Typebot! 🤖💬\n\n⏰ Oferta limitada, não fique de fora!\n\n👉 Garanta já o seu desconto: https://packtypebot.com.br\n💻 Cupom: BLACK",
        "height": 292.5581395348838,
        "width": 444.6511627906978,
        "color": 7
      },
      "id": "53ef7893-6d6e-4d32-a420-663468865c1f",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -820,
        60
      ]
    }
  ],
  "connections": {
    "RECUPERA ID BOTÃO 1": {
      "main": [
        [
          {
            "node": "RESPOSTA BOTÃO 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RECUPERA ID BOTÃO 2": {
      "main": [
        [
          {
            "node": "RESPOSTA BOTÃO 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RECUPERA ID BOTÃO 3": {
      "main": [
        [
          {
            "node": "RESPOSTA BOTÃO 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ENVIO DOS BOTÕES": {
      "main": [
        [
          {
            "node": "ARMAZENA ID BOTÃO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VARIÁVEIS": {
      "main": [
        [
          {
            "node": "GATILHO + ESCOLHA DO BOTÃO",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "VARIÁVEIS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GATILHO + ESCOLHA DO BOTÃO": {
      "main": [
        [
          {
            "node": "ENVIO DOS BOTÕES",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RECUPERA ID BOTÃO 1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RECUPERA ID BOTÃO 2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "RECUPERA ID BOTÃO 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "485ba6dc-d9ef-4b38-a10a-6570fd7971c0",
  "triggerCount": 0,
  "shared": [
    {
      "createdAt": "2024-11-09T16:01:08.250Z",
      "updatedAt": "2024-11-09T16:01:08.250Z",
      "role": "workflow:owner",
      "workflowId": "SEHMcqygbNQDSSnp",
      "projectId": "I3gAC3xI6nBnmwxf"
    }
  ],
  "tags": [
    {
      "createdAt": "2024-11-09T15:58:42.767Z",
      "updatedAt": "2024-11-09T15:58:42.767Z",
      "id": "0ViumP5xRhAbvXvd",
      "name": "Pack Typebot"
    }
  ]
}